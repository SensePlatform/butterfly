/*! butterfly           2014-11-04 */

(function(){var c,g,a,h,f,d,b,k,j,e=[].slice,i=[].indexOf||function(o){for(var n=0,m=this.length;n<m;n++){if(n in this&&this[n]===o){return n}}return -1};f=k=null;b=false;d=(new Date()).getTime();c=document.querySelectorAll.bind(document);document.addEventListener("DOMContentLoaded",function(){var o,q,m,s,r,n,l,p;r=function(t){return l.send("S"+t)};s=function(){return l.send("P")};console.log("Ping defined");setInterval(s,10000);m=function(){var t,v,u;u=arguments[0],t=2<=arguments.length?e.call(arguments,1):[];v=t.join(",");if(u==="Resize"){return l.send("R"+v)}};if(location.protocol==="https:"){p="wss://"}else{p="ws://"}p+=document.location.host+"/ws"+location.pathname;l=new WebSocket(p);l.addEventListener("open",function(){console.log("WebSocket open",arguments);l.send("R"+n.cols+","+n.rows);return d=(new Date()).getTime()});l.addEventListener("error",function(){return console.log("WebSocket error",arguments)});l.addEventListener("message",function(t){return setTimeout(function(){return n.write(t.data)},1)});l.addEventListener("close",function(){console.log("WebSocket closed",arguments);setTimeout(function(){n.write("Closed");n.skipNextKey=true;return n.element.classList.add("dead")},1);b=true;if((new Date()).getTime()-d>60*1000){return open("","_self").close()}});n=new a(c("#wrapper")[0],r,m);addEventListener("beforeunload",function(){if(!b){return"This will exit the terminal session"}});o=function(v){var t,u;if(v==null){v=100000000}t="";while(t.length<v){t+=Math.random().toString(36).substring(2)}u=(new Date()).getTime();n.write(t);return console.log(""+v+" chars in "+((new Date()).getTime()-u)+" ms")};q=function(v){var t,u;if(v==null){v=100000000}t="";while(t.length<v){t+="\x1b["+(30+parseInt(Math.random()*20))+"m";t+=Math.random().toString(36).substring(2)}u=(new Date()).getTime();n.write(t);return console.log(""+v+" chars + colors in "+((new Date()).getTime()-u)+" ms")};n.ws=l;return window.butterfly=n});h=function(l){if(l.preventDefault){l.preventDefault()}if(l.stopPropagation){l.stopPropagation()}l.cancelBubble=true;return false};j=0;g={normal:j++,escaped:j++,csi:j++,osc:j++,charset:j++,dcs:j++,ignore:j++};a=(function(){function l(q,o,n){var r,p,m;this.parent=q;this.out=o;this.ctl=n!=null?n:function(){};this.context=this.parent.ownerDocument.defaultView;this.document=this.parent.ownerDocument;this.body=this.document.getElementsByTagName("body")[0];this.element=this.document.createElement("div");this.element.className="terminal focus";this.element.style.outline="none";this.element.setAttribute("tabindex",0);this.element.setAttribute("spellcheck","false");this.parent.appendChild(this.element);r=this.document.createElement("div");r.className="line";this.element.appendChild(r);this.children=[r];this.compute_char_size();r.style.height=this.char_size.height+"px";m=this.parent.getBoundingClientRect();this.cols=Math.floor(m.width/this.char_size.width);this.rows=Math.floor(m.height/this.char_size.height);p=this.rows-1;while(p--){r=this.document.createElement("div");r.style.height=this.char_size.height+"px";r.className="line";this.element.appendChild(r);this.children.push(r)}this.scrollback=100000;this.visualBell=100;this.convertEol=false;this.termName="xterm";this.cursorBlink=true;this.cursorState=0;this.last_cc=0;this.reset_vars();this.refresh(0,this.rows-1);this.focus();this.startBlink();addEventListener("keydown",this.keyDown.bind(this));addEventListener("keypress",this.keyPress.bind(this));addEventListener("focus",this.focus.bind(this));addEventListener("blur",this.blur.bind(this));addEventListener("paste",this.paste.bind(this));addEventListener("resize",this.resize.bind(this));if(typeof InstallTrigger!=="undefined"){this.element.contentEditable="true";this.element.addEventListener("mouseup",function(){var s;s=getSelection().getRangeAt(0);if(s.startOffset===s.endOffset){return getSelection().removeAllRanges()}})}this.initmouse();setTimeout(this.resize.bind(this),100)}l.prototype.reset_vars=function(){var m;this.ybase=0;this.ydisp=0;this.x=0;this.y=0;this.cursorHidden=false;this.state=g.normal;this.queue="";this.scrollTop=0;this.scrollBottom=this.rows-1;this.applicationKeypad=false;this.applicationCursor=false;this.originMode=false;this.wraparoundMode=false;this.normal=null;this.charset=null;this.gcharset=null;this.glevel=0;this.charsets=[null];this.defAttr=(0<<18)|(257<<9)|(256<<0);this.curAttr=this.defAttr;this.params=[];this.currentParam=0;this.prefix="";this.lines=[];m=this.rows;while(m--){this.lines.push(this.blankLine())}this.setupStops();return this.skipNextKey=null};l.prototype.compute_char_size=function(){var m;m=document.createElement("span");m.textContent="0123456789";this.children[0].appendChild(m);this.char_size={width:m.getBoundingClientRect().width/10,height:this.children[0].getBoundingClientRect().height};return this.children[0].removeChild(m)};l.prototype.eraseAttr=function(){return(this.defAttr&~511)|(this.curAttr&511)};l.prototype.focus=function(){if(this.sendFocus){this.send("\x1b[I")}this.showCursor();this.element.classList.add("focus");return this.element.classList.remove("blur")};l.prototype.blur=function(){this.cursorState=1;this.refresh(this.y,this.y);if(this.sendFocus){this.send("\x1b[O")}this.element.classList.add("blur");return this.element.classList.remove("focus")};l.prototype.paste=function(m){if(m.clipboardData){this.send(m.clipboardData.getData("text/plain"))}else{if(this.context.clipboardData){this.send(this.context.clipboardData.getData("Text"))}}return h(m)};l.prototype.initmouse=function(){var q,m,o,r,n,s,p;r=32;n=function(u){var t,v;t=m(u);v=o(u);if(!v){return}s(t,v);switch(u.type){case"mousedown":return r=t;case"mouseup":return r=32}};p=function(u){var t,v;t=r;v=o(u);if(!v){return}t+=32;return s(t,v)};q=(function(t){return function(v,u){if(!t.utfMouse){if(u===255){return v.push(0)}if(u>127){u=127}return v.push(u)}else{if(u===2047){return v.push(0)}if(u<127){return v.push(u)}else{if(u>2047){u=2047}v.push(192|(u>>6));return v.push(128|(u&63))}}}})(this);s=(function(t){return function(u,w){var v;if(t.urxvtMouse){w.x-=32;w.y-=32;w.x++;w.y++;t.send("\x1b["+u+";"+w.x+";"+w.y+"M");return}if(t.sgrMouse){w.x-=32;w.y-=32;t.send("\x1b[<"+((u&3)===3?u&~3:u)+";"+w.x+";"+w.y+((u&3)===3?"m":"M"));return}v=[];q(v,u);q(v,w.x);q(v,w.y);return t.send("\x1b[M"+String.fromCharCode.apply(String,v))}})(this);m=(function(t){return function(x){var w,y,z,v,u;switch(x.type){case"mousedown":w=x.button!=null?+x.button:(x.which!=null?x.which-1:null);break;case"mouseup":w=3;break;case"wheel":w=x.deltaY<0?64:65}u=x.shiftKey?4:0;z=x.metaKey?8:0;y=x.ctrlKey?16:0;v=u|z|y;if(t.vt200Mouse){v&=y}else{if(!t.normalMouse){v=0}}return(32+(v<<2))+w}})(this);o=(function(t){return function(B){var A,z,v,u,C;u=B.pageX;C=B.pageY;A=t.element;while(A&&A!==t.document.documentElement){u-=A.offsetLeft;C-=A.offsetTop;A="offsetParent" in A?A.offsetParent:A.parentNode}v=t.element.clientWidth;z=t.element.clientHeight;u=Math.ceil((u/v)*t.cols);C=Math.ceil((C/z)*t.rows);if(u<0){u=0}if(u>t.cols){u=t.cols}if(C<0){C=0}if(C>t.rows){C=t.rows}u+=32;C+=32;return{x:u,y:C,type:B.type}}})(this);addEventListener("mousedown",(function(t){return function(v){var w,u;if(!t.mouseEvents){return}n(v);if(t.vt200Mouse){n({__proto__:v,type:"mouseup"});return h(v)}w=p.bind(t);if(t.normalMouse){addEventListener("mousemove",w)}if(!t.x10Mouse){addEventListener("mouseup",u=function(x){n(x);if(t.normalMouse){removeEventListener("mousemove",w)}removeEventListener("mouseup",u);return h(x)})}return h(v)}})(this));return addEventListener("wheel",(function(t){return function(u){if(t.mouseEvents){if(t.x10Mouse){return}n(u)}else{if(t.applicationKeypad){return}t.scrollDisp(u.deltaY>0?5:-5)}return h(u)}})(this))};l.prototype.refresh=function(p,s){var z,w,m,r,v,n,q,u,E,t,C,D,o,B,A;if(s-p>=this.rows/3){C=this.element.parentNode;if(C!=null){C.removeChild(this.element)}}o=this.cols;A=p;if(s>=this.lines.length){s=this.lines.length-1}while(A<=s){D=A+this.ydisp;E=this.lines[D];t="";if(A===this.y&&(this.ydisp===this.ybase||this.selectMode)&&!this.cursorHidden){B=this.x}else{B=-Infinity}z=this.defAttr;u=0;while(u<o){v=E[u][0];m=E[u][1];if(v!==z){if(z!==this.defAttr){t+="</span>"}if(v!==this.defAttr){r=[];t+="<span ";w=v&511;n=(v>>9)&511;q=v>>18;if(q&1){r.push("bold")}if(q&2){r.push("underline")}if(q&4){r.push("blink")}if(q&8){r.push("reverse-video")}if(q&16){r.push("invisible")}if(q&1&&n<8){n+=8}r.push("bg-color-"+w);r.push("fg-color-"+n);t+='class="';t+=r.join(" ");t+='">'}}if(u===B){t+='<span class="'+(this.cursorState?"reverse-video ":"")+'cursor">'}if(m.length>1){t+=m}else{switch(m){case"&":t+="&amp;";break;case"<":t+="&lt;";break;case">":t+="&gt;";break;default:if(m<=" "){t+="&nbsp;"}else{if(("\uff00"<m&&m<"\uffef")){u++}t+=m}}}if(u===B){t+="</span>"}z=v;u++}if(z!==this.defAttr){t+="</span>"}this.children[A].innerHTML=t;A++}return C!=null?C.appendChild(this.element):void 0};l.prototype._cursorBlink=function(){var m;this.cursorState^=1;m=this.element.querySelector(".cursor");if(!m){return}if(m.classList.contains("reverse-video")){return m.classList.remove("reverse-video")}else{return m.classList.add("reverse-video")}};l.prototype.showCursor=function(){if(!this.cursorState){this.cursorState=1;return this.refresh(this.y,this.y)}};l.prototype.startBlink=function(){if(!this.cursorBlink){return}this._blinker=(function(m){return function(){return m._cursorBlink()}})(this);return this.t_blink=setInterval(this._blinker,500)};l.prototype.refreshBlink=function(){if(!this.cursorBlink){return}clearInterval(this.t_blink);return this.t_blink=setInterval(this._blinker,500)};l.prototype.scroll=function(){var m;if(++this.ybase===this.scrollback){this.ybase=this.ybase/2|0;this.lines=this.lines.slice(-(this.ybase+this.rows)+1)}this.ydisp=this.ybase;m=this.ybase+this.rows-1;m-=this.rows-1-this.scrollBottom;if(m===this.lines.length){this.lines.push(this.blankLine())}else{this.lines.splice(m,0,this.blankLine())}if(this.scrollTop!==0){if(this.ybase!==0){this.ybase--;this.ydisp=this.ybase}this.lines.splice(this.ybase+this.scrollTop,1)}this.updateRange(this.scrollTop);return this.updateRange(this.scrollBottom)};l.prototype.scrollDisp=function(m){this.ydisp+=m;if(this.ydisp>this.ybase){this.ydisp=this.ybase}else{if(this.ydisp<0){this.ydisp=0}}return this.refresh(0,this.rows-1)};l.prototype.write=function(r){var n,t,s,p,o,u,m,q;this.refreshStart=this.y;this.refreshEnd=this.y;if(this.ybase!==this.ydisp){this.ydisp=this.ybase;this.maxRange()}s=0;o=r.length;while(s<o){n=r[s];switch(this.state){case g.normal:switch(n){case"\x07":this.bell();break;case"\n":case"\x0b":case"\x0c":if(this.convertEol){this.x=0}this.y++;if(this.y>this.scrollBottom){this.y--;this.scroll()}break;case"\r":this.x=0;break;case"\b":if(this.x>0){this.x--}break;case"\t":this.x=this.nextStop();break;case"\x0e":this.setgLevel(1);break;case"\x0f":this.setgLevel(0);break;case"\x1b":this.state=g.escaped;break;default:if(n>=" "){if((q=this.charset)!=null?q[n]:void 0){n=this.charset[n]}if(this.x>=this.cols){this.x=0;this.y++;if(this.y>this.scrollBottom){this.y--;this.scroll()}}this.lines[this.y+this.ybase][this.x]=[this.curAttr,n];this.x++;this.updateRange(this.y);if(("\uff00"<n&&n<"\uffef")){p=this.y+this.ybase;if(this.cols<2||this.x>=this.cols){this.lines[p][this.x-1]=[this.curAttr," "];break}this.lines[p][this.x]=[this.curAttr," "];this.x++}}}break;case g.escaped:switch(n){case"[":this.params=[];this.currentParam=0;this.state=g.csi;break;case"]":this.params=[];this.currentParam=0;this.state=g.osc;break;case"P":this.params=[];this.currentParam=0;this.state=g.dcs;break;case"_":this.state=g.ignore;break;case"^":this.state=g.ignore;break;case"c":this.reset();break;case"E":this.x=0;this.index();break;case"D":this.index();break;case"M":this.reverseIndex();break;case"%":this.setgLevel(0);this.setgCharset(0,l.prototype.charsets.US);this.state=g.normal;s++;break;case"(":case")":case"*":case"+":case"-":case".":switch(n){case"(":this.gcharset=0;break;case")":case"-":this.gcharset=1;break;case"*":case".":this.gcharset=2;break;case"+":this.gcharset=3}this.state=g.charset;break;case"/":this.gcharset=3;this.state=g.charset;s--;break;case"n":this.setgLevel(2);break;case"o":this.setgLevel(3);break;case"|":this.setgLevel(3);break;case"}":this.setgLevel(2);break;case"~":this.setgLevel(1);break;case"7":this.saveCursor();this.state=g.normal;break;case"8":this.restoreCursor();this.state=g.normal;break;case"#":this.state=g.normal;s++;break;case"H":this.tabSet();break;case"=":this.applicationKeypad=true;this.state=g.normal;break;case">":this.applicationKeypad=false;this.state=g.normal;break;default:this.state=g.normal;console.log("Unknown ESC control:",n)}break;case g.charset:switch(n){case"0":t=l.prototype.charsets.SCLD;break;case"A":t=l.prototype.charsets.UK;break;case"B":t=l.prototype.charsets.US;break;case"4":t=l.prototype.charsets.Dutch;break;case"C":case"5":t=l.prototype.charsets.Finnish;break;case"R":t=l.prototype.charsets.French;break;case"Q":t=l.prototype.charsets.FrenchCanadian;break;case"K":t=l.prototype.charsets.German;break;case"Y":t=l.prototype.charsets.Italian;break;case"E":case"6":t=l.prototype.charsets.NorwegianDanish;break;case"Z":t=l.prototype.charsets.Spanish;break;case"H":case"7":t=l.prototype.charsets.Swedish;break;case"=":t=l.prototype.charsets.Swiss;break;case"/":t=l.prototype.charsets.ISOLatin;s++;break;default:t=l.prototype.charsets.US}this.setgCharset(this.gcharset,t);this.gcharset=null;this.state=g.normal;break;case g.osc:if(n==="\x1b"||n==="\x07"){if(n==="\x1b"){s++}this.params.push(this.currentParam);switch(this.params[0]){case 0:case 1:case 2:if(this.params[1]){this.title=this.params[1]+" - ƸӜƷ butterfly";this.handleTitle(this.title)}}this.params=[];this.currentParam=0;this.state=g.normal}else{if(!this.params.length){if(n>="0"&&n<="9"){this.currentParam=this.currentParam*10+n.charCodeAt(0)-48}else{if(n===";"){this.params.push(this.currentParam);this.currentParam=""}}}else{this.currentParam+=n}}break;case g.csi:if(n==="?"||n===">"||n==="!"){this.prefix=n;break}if(n>="0"&&n<="9"){this.currentParam=this.currentParam*10+n.charCodeAt(0)-48;break}if(n==="$"||n==='"'||n===" "||n==="'"){break}this.params.push(this.currentParam);this.currentParam=0;if(n===";"){break}this.state=g.normal;switch(n){case"A":this.cursorUp(this.params);break;case"B":this.cursorDown(this.params);break;case"C":this.cursorForward(this.params);break;case"D":this.cursorBackward(this.params);break;case"H":this.cursorPos(this.params);break;case"J":this.eraseInDisplay(this.params);break;case"K":this.eraseInLine(this.params);break;case"m":if(!this.prefix){this.charAttributes(this.params)}break;case"n":if(!this.prefix){this.deviceStatus(this.params)}break;case"@":this.insertChars(this.params);break;case"E":this.cursorNextLine(this.params);break;case"F":this.cursorPrecedingLine(this.params);break;case"G":this.cursorCharAbsolute(this.params);break;case"L":this.insertLines(this.params);break;case"M":this.deleteLines(this.params);break;case"P":this.deleteChars(this.params);break;case"X":this.eraseChars(this.params);break;case"`":this.charPosAbsolute(this.params);break;case"a":this.HPositionRelative(this.params);break;case"c":this.sendDeviceAttributes(this.params);break;case"d":this.linePosAbsolute(this.params);break;case"e":this.VPositionRelative(this.params);break;case"f":this.HVPosition(this.params);break;case"h":this.setMode(this.params);break;case"l":this.resetMode(this.params);break;case"r":this.setScrollRegion(this.params);break;case"s":this.saveCursor(this.params);break;case"u":this.restoreCursor(this.params);break;case"I":this.cursorForwardTab(this.params);break;case"S":this.scrollUp(this.params);break;case"T":if(this.params.length<2&&!this.prefix){this.scrollDown(this.params)}break;case"Z":this.cursorBackwardTab(this.params);break;case"b":this.repeatPrecedingCharacter(this.params);break;case"g":this.tabClear(this.params);break;case"p":if(this.prefix==="!"){this.softReset(this.params)}break;default:console.error("Unknown CSI code: %s.",n)}this.prefix="";break;case g.dcs:if(n==="\x1b"||n==="\x07"){if(n==="\x1b"){s++}switch(this.prefix){case"":break;case"$q":u=this.currentParam;m=false;switch(u){case'"q':u='0"q';break;case'"p':u='61"p';break;case"r":u=""+(this.scrollTop+1)+";"+(this.scrollBottom+1)+"r";break;case"m":u="0m";break;default:console.error("Unknown DCS Pt: %s.",u);u=""}this.send("\x1bP"+ +m+"$r"+u+"\x1b\\");break;case"+q":u=this.currentParam;m=false;this.send("\x1bP"+ +m+"+r"+u+"\x1b\\");break;default:console.error("Unknown DCS prefix: %s.",this.prefix)}this.currentParam=0;this.prefix="";this.state=g.normal}else{if(!this.currentParam){if(!this.prefix&&n!=="$"&&n!=="+"){this.currentParam=n}else{if(this.prefix.length===2){this.currentParam=n}else{this.prefix+=n}}}else{this.currentParam+=n}}break;case g.ignore:if(n==="\x1b"||n==="\x07"){if(n==="\x1b"){s++}this.state=g.normal}}s++}this.updateRange(this.y);return this.refresh(this.refreshStart,this.refreshEnd)};l.prototype.writeln=function(m){return this.write(""+m+"\r\n")};l.prototype.keyDown=function(o){var q,n,m,p;if(o.keyCode>15&&o.keyCode<19){return true}if((o.shiftKey||o.ctrlKey)&&o.keyCode===45){return true}if((o.shiftKey&&o.ctrlKey)&&((p=o.keyCode)===67||p===86)){return true}if(o.altKey&&o.keyCode===90&&!this.skipNextKey){this.skipNextKey=true;this.element.classList.add("skip");return h(o)}if(this.skipNextKey){this.skipNextKey=false;this.element.classList.remove("skip");return true}switch(o.keyCode){case 8:n=o.altKey?"\x1b":"";if(o.shiftKey){n+="\x08";break}n+="\x7f";break;case 9:if(o.shiftKey){n="\x1b[Z";break}n="\t";break;case 13:n="\r";break;case 27:n="\x1b";break;case 37:if(this.applicationCursor){n="\x1bOD";break}n="\x1b[D";break;case 39:if(this.applicationCursor){n="\x1bOC";break}n="\x1b[C";break;case 38:if(this.applicationCursor){n="\x1bOA";break}if(o.ctrlKey){this.scrollDisp(-1);return h(o)}else{n="\x1b[A"}break;case 40:if(this.applicationCursor){n="\x1bOB";break}if(o.ctrlKey){this.scrollDisp(1);return h(o)}else{n="\x1b[B"}break;case 46:n="\x1b[3~";break;case 45:n="\x1b[2~";break;case 36:if(this.applicationKeypad){n="\x1bOH";break}n="\x1bOH";break;case 35:if(this.applicationKeypad){n="\x1bOF";break}n="\x1bOF";break;case 33:if(o.shiftKey){this.scrollDisp(-(this.rows-1));return h(o)}else{n="\x1b[5~"}break;case 34:if(o.shiftKey){this.scrollDisp(this.rows-1);return h(o)}else{n="\x1b[6~"}break;case 112:n="\x1bOP";break;case 113:n="\x1bOQ";break;case 114:n="\x1bOR";break;case 115:n="\x1bOS";break;case 116:n="\x1b[15~";break;case 117:n="\x1b[17~";break;case 118:n="\x1b[18~";break;case 119:n="\x1b[19~";break;case 120:n="\x1b[20~";break;case 121:n="\x1b[21~";break;case 122:n="\x1b[23~";break;case 123:n="\x1b[24~";break;default:if(o.ctrlKey){if(o.keyCode>=65&&o.keyCode<=90){if(o.keyCode===67){m=(new Date()).getTime();if((m-this.last_cc)<75){q=(setTimeout(function(){}))-6;this.write("\r\n --8<------8<-- Sectioned --8<------8<-- \r\n\r\n");while(q--){if(q!==this.t_bell&&q!==this.t_queue&&q!==this.t_blink){clearTimeout(q)}}}this.last_cc=m}n=String.fromCharCode(o.keyCode-64)}else{if(o.keyCode===32){n=String.fromCharCode(0)}else{if(o.keyCode>=51&&o.keyCode<=55){n=String.fromCharCode(o.keyCode-51+27)}else{if(o.keyCode===56){n=String.fromCharCode(127)}else{if(o.keyCode===219){n=String.fromCharCode(27)}else{if(o.keyCode===221){n=String.fromCharCode(29)}}}}}}}else{if((o.altKey&&i.call(navigator.platform,"Mac")<0)||(o.metaKey&&i.call(navigator.platform,"Mac")>=0)){if(o.keyCode>=65&&o.keyCode<=90){n="\x1b"+String.fromCharCode(o.keyCode+32)}else{if(o.keyCode===192){n="\x1b`"}else{if(o.keyCode>=48&&o.keyCode<=57){n="\x1b"+(o.keyCode-48)}}}}}}if(o.keyCode>=37&&o.keyCode<=40){if(o.ctrlKey){n=n.slice(0,-1)+"1;5"+n.slice(-1)}else{if(o.altKey){n=n.slice(0,-1)+"1;3"+n.slice(-1)}else{if(o.shiftKey){n=n.slice(0,-1)+"1;4"+n.slice(-1)}}}}if(!n){return true}if(this.prefixMode){this.leavePrefix();return h(o)}if(this.selectMode){this.keySelect(o,n);return h(o)}this.showCursor();this.handler(n);return h(o)};l.prototype.setgLevel=function(m){this.glevel=m;return this.charset=this.charsets[m]};l.prototype.setgCharset=function(m,n){this.charsets[m]=n;if(this.glevel===m){return this.charset=n}};l.prototype.keyPress=function(n){var m;if(this.skipNextKey===false){this.skipNextKey=null;return true}if(n.charCode){m=n.charCode}else{if(n.which==null){m=n.keyCode}else{if(n.which!==0&&n.charCode!==0){m=n.which}else{return false}}}if(!m||n.ctrlKey||n.altKey||n.metaKey){return false}m=String.fromCharCode(m);this.showCursor();this.handler(m);return false};l.prototype.send=function(m){if(!this.queue){this.t_queue=setTimeout(((function(n){return function(){n.handler(n.queue);return n.queue=""}})(this)),1)}return this.queue+=m};l.prototype.bell=function(){if(!this.visualBell){return}this.element.classList.add("bell");return this.t_bell=setTimeout(((function(m){return function(){return m.element.classList.remove("bell")}})(this)),this.visualBell)};l.prototype.resize=function(){var r,q,p,o,n,t,s,m;t=this.cols;s=this.rows;this.compute_char_size();m=this.parent.getBoundingClientRect();this.cols=Math.floor(m.width/this.char_size.width);this.rows=Math.floor(m.height/this.char_size.height);if(t===this.cols&&s===this.rows){return}this.ctl("Resize",this.cols,this.rows);if(t<this.cols){r=[this.defAttr," "];p=this.lines.length;while(p--){while(this.lines[p].length<this.cols){this.lines[p].push(r)}}}else{if(t>this.cols){p=this.lines.length;while(p--){while(this.lines[p].length>this.cols){this.lines[p].pop()}}}}this.setupStops(t);o=s;if(o<this.rows){q=this.element;while(o++<this.rows){if(this.lines.length<this.rows+this.ybase){this.lines.push(this.blankLine())}if(this.children.length<this.rows){n=this.document.createElement("div");n.className="line";n.style.height=this.char_size.height+"px";q.appendChild(n);this.children.push(n)}}}else{if(o>this.rows){while(o-->this.rows){if(this.lines.length>this.rows+this.ybase){this.lines.pop()}if(this.children.length>this.rows){q=this.children.pop();if(!q){continue}q.parentNode.removeChild(q)}}}}if(this.y>=this.rows){this.y=this.rows-1}if(this.x>=this.cols){this.x=this.cols-1}this.scrollTop=0;this.scrollBottom=this.rows-1;this.refresh(0,this.rows-1);return this.normal=null};l.prototype.updateRange=function(m){if(m<this.refreshStart){this.refreshStart=m}if(m>this.refreshEnd){return this.refreshEnd=m}};l.prototype.maxRange=function(){this.refreshStart=0;return this.refreshEnd=this.rows-1};l.prototype.setupStops=function(n){var m;if(n!=null){if(!this.tabs[n]){n=this.prevStop(n)}}else{this.tabs={};n=0}m=[];while(n<this.cols){this.tabs[n]=true;m.push(n+=8)}return m};l.prototype.prevStop=function(m){if(m==null){m=this.x}while(!this.tabs[--m]&&m>0){1}if(m>=this.cols){return this.cols-1}else{if(m<0){return 0}else{return m}}};l.prototype.nextStop=function(m){if(m==null){m=this.x}while(!this.tabs[++m]&&m<this.cols){1}if(m>=this.cols){return this.cols-1}else{if(m<0){return 0}else{return m}}};l.prototype.eraseRight=function(m,p){var o,n;n=this.lines[this.ybase+p];o=[this.eraseAttr()," "];while(m<this.cols){n[m]=o;m++}return this.updateRange(p)};l.prototype.eraseLeft=function(m,p){var o,n;n=this.lines[this.ybase+p];o=[this.eraseAttr()," "];m++;while(m--){n[m]=o}return this.updateRange(p)};l.prototype.eraseLine=function(m){return this.eraseRight(0,m)};l.prototype.blankLine=function(q){var m,p,o,n;m=(q?this.eraseAttr():this.defAttr);p=[m," "];n=[];o=0;while(o<this.cols){n[o]=p;o++}return n};l.prototype.ch=function(m){if(m){return[this.eraseAttr()," "]}else{return[this.defAttr," "]}};l.prototype.isterm=function(m){return(""+this.termName).indexOf(m)===0};l.prototype.handler=function(m){return this.out(m)};l.prototype.handleTitle=function(m){return document.title=m};l.prototype.index=function(){this.y++;if(this.y>this.scrollBottom){this.y--;this.scroll()}return this.state=g.normal};l.prototype.reverseIndex=function(){var m;this.y--;if(this.y<this.scrollTop){this.y++;this.lines.splice(this.y+this.ybase,0,this.blankLine(true));m=this.rows-1-this.scrollBottom;this.lines.splice(this.rows-1+this.ybase-m+1,1);this.updateRange(this.scrollTop);this.updateRange(this.scrollBottom)}return this.state=g.normal};l.prototype.reset=function(){this.reset_vars();return this.refresh(0,this.rows-1)};l.prototype.tabSet=function(){this.tabs[this.x]=true;return this.state=g.normal};l.prototype.cursorUp=function(n){var m;m=n[0];if(m<1){m=1}this.y-=m;if(this.y<0){return this.y=0}};l.prototype.cursorDown=function(n){var m;m=n[0];if(m<1){m=1}this.y+=m;if(this.y>=this.rows){return this.y=this.rows-1}};l.prototype.cursorForward=function(n){var m;m=n[0];if(m<1){m=1}this.x+=m;if(this.x>=this.cols){return this.x=this.cols-1}};l.prototype.cursorBackward=function(n){var m;m=n[0];if(m<1){m=1}this.x-=m;if(this.x<0){return this.x=0}};l.prototype.cursorPos=function(o){var m,n;n=o[0]-1;if(o.length>=2){m=o[1]-1}else{m=0}if(n<0){n=0}else{if(n>=this.rows){n=this.rows-1}}if(m<0){m=0}else{if(m>=this.cols){m=this.cols-1}}this.x=m;return this.y=n};l.prototype.eraseInDisplay=function(q){var o,m,p,n;switch(q[0]){case 0:this.eraseRight(this.x,this.y);o=this.y+1;m=[];while(o<this.rows){this.eraseLine(o);m.push(o++)}return m;break;case 1:this.eraseLeft(this.x,this.y);o=this.y;p=[];while(o--){p.push(this.eraseLine(o))}return p;break;case 2:o=this.rows;n=[];while(o--){n.push(this.eraseLine(o))}return n}};l.prototype.eraseInLine=function(m){switch(m[0]){case 0:return this.eraseRight(this.x,this.y);case 1:return this.eraseLeft(this.x,this.y);case 2:return this.eraseLine(this.y)}};l.prototype.charAttributes=function(t){var r,o,n,q,m,s;if(t.length===1&&t[0]===0){this.curAttr=this.defAttr;return}n=this.curAttr>>18;o=(this.curAttr>>9)&511;r=this.curAttr&511;m=t.length;q=0;while(q<m){s=t[q];if(s>=30&&s<=37){o=s-30}else{if(s>=40&&s<=47){r=s-40}else{if(s>=90&&s<=97){s+=8;o=s-90}else{if(s>=100&&s<=107){s+=8;r=s-100}else{if(s===0){n=this.defAttr>>18;o=(this.defAttr>>9)&511;r=this.defAttr&511}else{if(s===1){n|=1}else{if(s===4){n|=2}else{if(s===5){n|=4}else{if(s===7){n|=8}else{if(s===8){n|=16}else{if(s===22){n&=~1}else{if(s===24){n&=~2}else{if(s===25){n&=~4}else{if(s===27){n&=~8}else{if(s===28){n&=~16}else{if(s===39){o=(this.defAttr>>9)&511}else{if(s===49){r=this.defAttr&511}else{if(s===38){if(t[q+1]===2){q+=2;o="#"+t[q]&255+t[q+1]&255+t[q+2]&255;q+=2}else{if(t[q+1]===5){q+=2;o=t[q]&255}}}else{if(s===48){if(t[q+1]===2){q+=2;r="#"+t[q]&255+t[q+1]&255+t[q+2]&255;q+=2}else{if(t[q+1]===5){q+=2;r=t[q]&255}}}else{if(s===100){o=(this.defAttr>>9)&511;r=this.defAttr&511}else{console.error("Unknown SGR attribute: %d.",s)}}}}}}}}}}}}}}}}}}}}q++}return this.curAttr=(n<<18)|(o<<9)|r};l.prototype.deviceStatus=function(m){if(!this.prefix){switch(m[0]){case 5:return this.send("\x1b[0n");case 6:return this.send("\x1b["+(this.y+1)+";"+(this.x+1)+"R")}}else{if(this.prefix==="?"){if(m[0]===6){return this.send("\x1b[?"+(this.y+1)+";"+(this.x+1)+"R")}}}};l.prototype.insertChars=function(r){var o,n,q,p,m;q=r[0];if(q<1){q=1}p=this.y+this.ybase;n=this.x;o=[this.eraseAttr()," "];m=[];while(q--&&n<this.cols){this.lines[p].splice(n++,0,o);m.push(this.lines[p].pop())}return m};l.prototype.cursorNextLine=function(n){var m;m=n[0];if(m<1){m=1}this.y+=m;if(this.y>=this.rows){this.y=this.rows-1}return this.x=0};l.prototype.cursorPrecedingLine=function(n){var m;m=n[0];if(m<1){m=1}this.y-=m;if(this.y<0){this.y=0}return this.x=0};l.prototype.cursorCharAbsolute=function(n){var m;m=n[0];if(m<1){m=1}return this.x=m-1};l.prototype.insertLines=function(p){var m,o,n;o=p[0];if(o<1){o=1}n=this.y+this.ybase;m=this.rows-1-this.scrollBottom;m=this.rows-1+this.ybase-m+1;while(o--){this.lines.splice(n,0,this.blankLine(true));this.lines.splice(m,1)}this.updateRange(this.y);return this.updateRange(this.scrollBottom)};l.prototype.deleteLines=function(p){var m,o,n;o=p[0];if(o<1){o=1}n=this.y+this.ybase;m=this.rows-1-this.scrollBottom;m=this.rows-1+this.ybase-m;while(o--){this.lines.splice(m+1,0,this.blankLine(true));this.lines.splice(n,1)}this.updateRange(this.y);return this.updateRange(this.scrollBottom)};l.prototype.deleteChars=function(q){var n,p,o,m;p=q[0];if(p<1){p=1}o=this.y+this.ybase;n=[this.eraseAttr()," "];m=[];while(p--){this.lines[o].splice(this.x,1);m.push(this.lines[o].push(n))}return m};l.prototype.eraseChars=function(r){var o,n,q,p,m;q=r[0];if(q<1){q=1}p=this.y+this.ybase;n=this.x;o=[this.eraseAttr()," "];m=[];while(q--&&n<this.cols){m.push(this.lines[p][n++]=o)}return m};l.prototype.charPosAbsolute=function(n){var m;m=n[0];if(m<1){m=1}this.x=m-1;if(this.x>=this.cols){return this.x=this.cols-1}};l.prototype.HPositionRelative=function(n){var m;m=n[0];if(m<1){m=1}this.x+=m;if(this.x>=this.cols){return this.x=this.cols-1}};l.prototype.sendDeviceAttributes=function(m){if(m[0]>0){return}if(!this.prefix){if(this.isterm("xterm")||this.isterm("rxvt-unicode")||this.isterm("screen")){return this.send("\x1b[?1;2c")}else{if(this.isterm("linux")){return this.send("\x1b[?6c")}}}else{if(this.prefix===">"){if(this.isterm("xterm")){return this.send("\x1b[>0;276;0c")}else{if(this.isterm("rxvt-unicode")){return this.send("\x1b[>85;95;0c")}else{if(this.isterm("linux")){return this.send(m[0]+"c")}else{if(this.isterm("screen")){return this.send("\x1b[>83;40003;0c")}}}}}}};l.prototype.linePosAbsolute=function(n){var m;m=n[0];if(m<1){m=1}this.y=m-1;if(this.y>=this.rows){return this.y=this.rows-1}};l.prototype.VPositionRelative=function(n){var m;m=n[0];if(m<1){m=1}this.y+=m;if(this.y>=this.rows){return this.y=this.rows-1}};l.prototype.HVPosition=function(m){if(m[0]<1){m[0]=1}if(m[1]<1){m[1]=1}this.y=m[0]-1;if(this.y>=this.rows){this.y=this.rows-1}this.x=m[1]-1;if(this.x>=this.cols){return this.x=this.cols-1}};l.prototype.setMode=function(p){var n,m,o;if(typeof p==="object"){m=p.length;n=0;while(n<m){this.setMode(p[n]);n++}return}if(this.prefix==="?"){switch(p){case 1:return this.applicationCursor=true;case 2:this.setgCharset(0,l.prototype.charsets.US);this.setgCharset(1,l.prototype.charsets.US);this.setgCharset(2,l.prototype.charsets.US);return this.setgCharset(3,l.prototype.charsets.US);case 3:this.savedCols=this.cols;return this.resize(132,this.rows);case 6:return this.originMode=true;case 7:return this.wraparoundMode=true;case 66:return this.applicationKeypad=true;case 9:case 1000:case 1002:case 1003:this.x10Mouse=p===9;this.vt200Mouse=p===1000;this.normalMouse=p>1000;this.mouseEvents=true;return this.element.style.cursor="pointer";case 1004:return this.sendFocus=true;case 1005:return this.utfMouse=true;case 1006:return this.sgrMouse=true;case 1015:return this.urxvtMouse=true;case 25:return this.cursorHidden=false;case 1049:case 47:case 1047:if(!this.normal){o={lines:this.lines,ybase:this.ybase,ydisp:this.ydisp,x:this.x,y:this.y,scrollTop:this.scrollTop,scrollBottom:this.scrollBottom,tabs:this.tabs};this.reset();this.normal=o;return this.showCursor()}}}};l.prototype.resetMode=function(o){var n,m;if(typeof o==="object"){m=o.length;n=0;while(n<m){this.resetMode(o[n]);n++}return}if(this.prefix==="?"){switch(o){case 1:return this.applicationCursor=false;case 3:if(this.cols===132&&this.savedCols){this.resize(this.savedCols,this.rows)}return delete this.savedCols;case 6:return this.originMode=false;case 7:return this.wraparoundMode=false;case 66:return this.applicationKeypad=false;case 9:case 1000:case 1002:case 1003:this.x10Mouse=false;this.vt200Mouse=false;this.normalMouse=false;this.mouseEvents=false;return this.element.style.cursor="";case 1004:return this.sendFocus=false;case 1005:return this.utfMouse=false;case 1006:return this.sgrMouse=false;case 1015:return this.urxvtMouse=false;case 25:return this.cursorHidden=true;case 1049:case 47:case 1047:if(this.normal){this.lines=this.normal.lines;this.ybase=this.normal.ybase;this.ydisp=this.normal.ydisp;this.x=this.normal.x;this.y=this.normal.y;this.scrollTop=this.normal.scrollTop;this.scrollBottom=this.normal.scrollBottom;this.tabs=this.normal.tabs;this.normal=null;this.refresh(0,this.rows-1);return this.showCursor()}}}};l.prototype.setScrollRegion=function(m){if(this.prefix){return}this.scrollTop=(m[0]||1)-1;this.scrollBottom=(m[1]||this.rows)-1;this.x=0;return this.y=0};l.prototype.saveCursor=function(m){this.savedX=this.x;return this.savedY=this.y};l.prototype.restoreCursor=function(m){this.x=this.savedX||0;return this.y=this.savedY||0};l.prototype.cursorForwardTab=function(o){var n,m;n=o[0]||1;m=[];while(n--){m.push(this.x=this.nextStop())}return m};l.prototype.scrollUp=function(n){var m;m=n[0]||1;while(m--){this.lines.splice(this.ybase+this.scrollTop,1);this.lines.splice(this.ybase+this.scrollBottom,0,this.blankLine())}this.updateRange(this.scrollTop);return this.updateRange(this.scrollBottom)};l.prototype.scrollDown=function(n){var m;m=n[0]||1;while(m--){this.lines.splice(this.ybase+this.scrollBottom,1);this.lines.splice(this.ybase+this.scrollTop,0,this.blankLine())}this.updateRange(this.scrollTop);return this.updateRange(this.scrollBottom)};l.prototype.initMouseTracking=function(m){};l.prototype.resetTitleModes=function(m){};l.prototype.cursorBackwardTab=function(o){var n,m;n=o[0]||1;m=[];while(n--){m.push(this.x=this.prevStop())}return m};l.prototype.repeatPrecedingCharacter=function(q){var o,n,p,m;p=q[0]||1;n=this.lines[this.ybase+this.y];o=n[this.x-1]||[this.defAttr," "];m=[];while(p--){m.push(n[this.x++]=o)}return m};l.prototype.tabClear=function(n){var m;m=n[0];if(m<=0){return delete this.tabs[this.x]}else{if(m===3){return this.tabs={}}}};l.prototype.mediaCopy=function(m){};l.prototype.setResources=function(m){};l.prototype.disableModifiers=function(m){};l.prototype.setPointerMode=function(m){};l.prototype.softReset=function(m){this.cursorHidden=false;this.insertMode=false;this.originMode=false;this.wraparoundMode=false;this.applicationKeypad=false;this.applicationCursor=false;this.scrollTop=0;this.scrollBottom=this.rows-1;this.curAttr=this.defAttr;this.x=this.y=0;this.charset=null;this.glevel=0;return this.charsets=[null]};l.prototype.requestAnsiMode=function(m){};l.prototype.requestPrivateMode=function(m){};l.prototype.setConformanceLevel=function(m){};l.prototype.loadLEDs=function(m){};l.prototype.setCursorStyle=function(m){};l.prototype.setCharProtectionAttr=function(m){};l.prototype.restorePrivateValues=function(m){};l.prototype.setAttrInRectangle=function(v){var n,m,s,p,o,u,q;q=v[0];p=v[1];m=v[2];u=v[3];n=v[4];while(q<m+1){o=this.lines[this.ybase+q];s=p;while(s<u){o[s]=[n,o[s][1]];s++}q++}this.updateRange(v[0]);return this.updateRange(v[2])};l.prototype.savePrivateValues=function(m){};l.prototype.manipulateWindow=function(m){};l.prototype.reverseAttrInRectangle=function(m){};l.prototype.setTitleModeFeature=function(m){};l.prototype.setWarningBellVolume=function(m){};l.prototype.setMarginBellVolume=function(m){};l.prototype.copyRectangle=function(m){};l.prototype.enableFilterRectangle=function(m){};l.prototype.requestParameters=function(m){};l.prototype.selectChangeExtent=function(m){};l.prototype.fillRectangle=function(v){var m,s,q,o,n,u,p;s=v[0];p=v[1];o=v[2];m=v[3];u=v[4];while(p<m+1){n=this.lines[this.ybase+p];q=o;while(q<u){n[q]=[n[q][0],String.fromCharCode(s)];q++}p++}this.updateRange(v[1]);return this.updateRange(v[3])};l.prototype.enableLocatorReporting=function(n){var m;return m=n[0]>0};l.prototype.eraseRectangle=function(v){var m,s,q,o,n,u,p;p=v[0];o=v[1];m=v[2];u=v[3];s=[this.eraseAttr()," "];while(p<m+1){n=this.lines[this.ybase+p];q=o;while(q<u){n[q]=s;q++}p++}this.updateRange(v[0]);return this.updateRange(v[2])};l.prototype.setLocatorEvents=function(m){};l.prototype.selectiveEraseRectangle=function(m){};l.prototype.requestLocatorPosition=function(m){};l.prototype.insertColumns=function(){var o,n,m,p;p=params[0];m=this.ybase+this.rows;o=[this.eraseAttr()," "];while(p--){n=this.ybase;while(n<m){this.lines[n].splice(this.x+1,0,o);this.lines[n].pop();n++}}return this.maxRange()};l.prototype.deleteColumns=function(){var o,n,m,p;p=params[0];m=this.ybase+this.rows;o=[this.eraseAttr()," "];while(p--){n=this.ybase;while(n<m){this.lines[n].splice(this.x,1);this.lines[n].push(o);n++}}return this.maxRange()};l.prototype.get_html_height_in_lines=function(m){var o,n;n=document.createElement("div");n.innerHTML=m;this.element.appendChild(n);o=n.getBoundingClientRect().height;this.element.removeChild(n);return Math.ceil(o/this.char_size.height)};l.prototype.charsets={SCLD:{"`":"◆",a:"▒",b:"\t",c:"\f",d:"\r",e:"\n",f:"°",g:"±",h:"␤",i:"\x0b",j:"┘",k:"┐",l:"┌",m:"└",n:"┼",o:"⎺",p:"⎻",q:"─",r:"⎼",s:"⎽",t:"├",u:"┤",v:"┴",w:"┬",x:"│",y:"≤",z:"≥","{":"π","|":"≠","}":"£","~":"·"},UK:null,US:null,Dutch:null,Finnish:null,French:null,FrenchCanadian:null,German:null,Italian:null,NorwegianDanish:null,Spanish:null,Swedish:null,Swiss:null,ISOLatin:null};return l})();window.Terminal=a}).call(this);
//# sourceMappingURL=main.min.js.map